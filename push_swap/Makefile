CC= gcc
GFLAGS= -Wall -Werror -Wextra
LIB= -Llibft -lft -Llibftprintf -lftprintf 
SRCS=$(wildcard srcs/*.c)
OBJS=$(SRCS:.c=.o)
NAME=push_swap
DATE=$(shell date | sed 's/ /_/g')

all: $(NAME)

%.o: %.c
	$(CC) $(GFLAGS) -c $< -o $@

$(NAME): $(OBJS)
	cd libft && make bonus
	cd ..
	$(CC) $(GFLAGS) $(OBJS) ${LIB} -o $(NAME)

clean:
	rm -rf *.out
	rm -rf *.dSYM
	rm -f filename
	cd srcs && rm -f *.o

fclean: clean
	rm -f $(NAME)

re: fclean all

gdev:
	cd .. && git add .
	git commit -m $(NAME)/$(DATE) 
	git push

lib:
	cd libft && rm -f libft.a  && make bonus && make clean
	cd libftprintf && rm -f libftprintf.a && make

libft-update:
	rm -rf libft
	cp -r ../libft .
	cd libft && make bonus && make clean
	
test:
	$(CC) $(GFLAGS) test/*.c srcs/* ${LIB}  -o test/test
	
check:
	test/checker_Mac42 $(ARGS) 

exam:
	$(CC) $(GFLAGS) test/exercice_exam.c -Llib -lft -lftprintf -o test/exam
	test/exam

.PHONY: re all clean fclean test lib exam check test ft_printf ft lib gdev libftupdate

#https://www.calculatorsoup.com/calculators/statistics/random-number-generator.php

mode=
ARG_0=
ARG_SORT1= "0 1 2 3"
ARG_SORT2= "0 1 2 3 4 5 6 7 8 9"
ARG_3= "2,1,0"
ARG_5= "1 5 2 4 3"
ARG_51= "21 62 249 -228 417"
ARG_10= "460 -345 -85 -24 112 162 -78 -258 -347 -224"
ARG_100= "-123 -188 -344 -63 285 372 41 282 -394 -83 -15 -9 63 -294 275 -307 431 -147 124 393 -385 96 240 7 303 15 -437 -417 139 -395 69 -343 498 -363 -408 -84 217 81 144 135 -386 434 -440 108 118 20 328 175 304 313 415 -209 381 -34 -486 97 -260 -14 -459 373 -494 -131 -414 -54 70 -72 267 333 -117 -86 -259 -88 183 -482 90 475 259 57 65 316 -24 -187 -61 -2 -36 -264 436 -75 -401 -299 -206 297 359 409 387 -495 220 469 -365 375"
ARG_500= "250 -461 -177 -173 -260 229 500 -344 -420 -194 -184 369 -250 -473 271 9 240 -103 236 -355 -322 496 353 -130 158 277 -234 418 443 386 287 -8 -356 -179 471 281 489 228 -46 199 -87 466 51 292 -413 151 -417 288 81 -298 112 318 -189 218 -245 -440 -350 -330 -390 -365 -123 200 362 495 486 -249 37 -447 72 483 -357 136 33 -395 429 34 39 181 -492 428 -112 177 -219 128 -370 -466 437 -285 -167 -475 -26 442 331 -445 -27 -472 -29 -345 393 -135 -288 237 148 165 -38 -319 -202 -16 -223 -317 -484 -309 354 -57 -272 -14 -168 273 -399 50 -232 -301 214 -23 -109 -171 -215 479 -37 306 -175 124 430 482 -469 -289 -256 -162 185 497 153 -481 263 -13 157 408 426 55 16 149 -496 76 42 -313 161 137 -115 125 97 338 -235 -433 223 58 275 -203 388 -236 156 65 -100 -119 -147 -348 -106 448 449 116 -161 -414 67 307 -407 -442 -41 -84 -393 -283 311 118 69 232 451 -299 -454 -54 150 279 351 -214 -452 407 -363 -362 89 71 212 283 85 172 160 446 -97 -360 45 -353 -18 44 299 -477 -3 238 289 -276 487 -11 290 -102 361 -281 -349 -331 485 107 -368 -95 -485 57 -427 60 416 -30 -148 397 -441 21 -277 387 297 -82 -432 425 4 25 474 189 259 -80 109 -297 -86 308 -266 -398 -197 -346 135 453 410 463 -371 -224 272 -388 -489 -453 -455 -306 -255 -91 -296 231 221 -10 -308 -150 163 -21 494 15 -71 -233 -188 -448 320 -324 -450 -278 -68 -166 78 7 -307 13 230 226 498 424 -248 -149 391 266 406 330 207 -36 -488 -78 264 493 419 74 -210 -269 30 -438 -378 -114 -211 301 404 420 -271 73 -409 434 -201 -284 -336 -499 205 455 -304 225 -364 379 344 -142 198 460 -495 -497 285 359 -246 -436 -172 -286 133 -305 -280 234 491 261 174 188 246 -252 -421 -52 215 24 47 -216 -321 363 -61 -90 -208 -205 222 347 295 18 -212 304 147 -151 -408 -198 -373 27 -275 -180 242 -367 -153 -7 382 -343 -400 389 317 -221 490 355 -471 104 411 -28 -20 131 -465 -423 -182 173 -48 100 -416 -75 -129 -389 -2 213 357 -415 -328 -434 77 -295 -169 53 375 90 113 -262 -77 -64 35 -464 130 217 -193 413 32 167 204 327 -253 381 155 193 159 -122 -418 -191 -143 -422 -5 190 -366 101 102 278 378 -494 59 315 -498 -430 -339 -83 196 -160 319 143 394 343 26 -165 -4 103 258 -405 402 313 -96 144 341 -32 206 -318 -391 -206 -474 472 -435 -63 256 -218"

ifeq ($(mode), 0)		#no arg
ARG= $(ARG_0)
else ifeq ($(mode), 1)	# arg sort
ARG= $(ARG_SORT1)
else ifeq ($(mode), 2)	# arg srt 2
ARG= $(ARG_SORT2)
else ifeq ($(mode), 3)	# 3 value
ARG= $(ARG_3)
else ifeq ($(mode), 4)	#5 value
ARG= $(ARG_5)
else ifeq ($(mode), 5) #5 five value 2
ARG= $(ARG_51)
else ifeq ($(mode), 6)	#100 value
ARG= $(ARG_100)
else ifeq ($(mode), 7) #500 value
ARG= $(ARG_500)
endif

c:
	valgrind --log-file=filename --leak-check=full ./push_swap $(ARG) | ./checker_linux $(ARG)

cl:
	valgrind --log-file=filename --leak-check=full ./push_swap $(ARG) | ./checker_linux $(ARG) | wc -l